<!-- Trigger Button (Visible in Search Bar) -->
<button class="filter-btn" (click)="toggleOpen()">
  <lucide-icon [img]="icons.SlidersHorizontal" size="16"></lucide-icon>
</button>

<!-- Modal Overlay -->
@if (isOpen) {

  <div class="backdrop-click-catcher" (click)="isOpen = false"></div>

  <div class="modal-overlay" (click)="isOpen = false">
    <div class="modal-content" (click)="$event.stopPropagation()">

      <!-- Header -->
      <div class="modal-header">
        <h3>Advanced Search</h3>
        <button app-button variant="ghost" size="icon" (click)="isOpen = false">
          <lucide-icon [img]="icons.X" size="16"></lucide-icon>
        </button>
      </div>

      <!-- Body -->
      <div class="modal-body">

        <!-- From -->
        <div class="grid-row">
          <label>From</label>
          <input type="text" [(ngModel)]="options.from" class="form-input">
        </div>

        <!-- To -->
        <div class="grid-row">
          <label>To</label>
          <input type="text" [(ngModel)]="options.to" class="form-input">
        </div>

        <!-- Subject -->
        <div class="grid-row">
          <label>Subject</label>
          <input type="text" [(ngModel)]="options.subject" class="form-input">
        </div>

        <!-- Includes Words -->
        <div class="grid-row">
          <label>Includes words</label>
          <input type="text" [(ngModel)]="options.includesWords" class="form-input">
        </div>

        <!-- Doesn't Have -->
        <div class="grid-row">
          <label>Doesn't have</label>
          <input type="text" [(ngModel)]="options.doesntHave" class="form-input">
        </div>

        <!-- Size -->
        <div class="grid-row">
          <label>Size</label>
          <div class="flex-group">
            <select [(ngModel)]="options.sizeOperator" class="form-select w-small">
              <option value="greater">greater than</option>
              <option value="less">less than</option>
            </select>
            <input type="number" [(ngModel)]="options.sizeValue" class="form-input flex-1">
            <select [(ngModel)]="options.sizeUnit" class="form-select w-tiny">
              <option value="MB">MB</option>
              <option value="KB">KB</option>
              <option value="bytes">bytes</option>
            </select>
          </div>
        </div>

        <!-- Date Within -->
        <div class="grid-row">
          <label>Date within</label>
          <div class="flex-group">
            <select [(ngModel)]="options.dateWithin" class="form-select w-small">
              <option value="1 day">1 day</option>
              <option value="3 days">3 days</option>
              <option value="1 week">1 week</option>
              <option value="2 weeks">2 weeks</option>
              <option value="1 month">1 month</option>
              <option value="3 months">3 months</option>
              <option value="6 months">6 months</option>
              <option value="1 year">1 year</option>
            </select>
            <div class="relative-input flex-1">
              <input type="date" [(ngModel)]="options.dateValue" class="form-input pr-icon">
              <!-- Calendar Icon is decorative/indicator -->
              <!-- <lucide-icon [img]="icons.Calendar" class="input-icon"></lucide-icon> -->
            </div>
          </div>
        </div>

        <!-- Search In -->
        <div class="grid-row">
          <label>Search</label>
          <select [(ngModel)]="options.searchFolder" class="form-select">
            <option value="all">All Mail</option>
            @for (folder of folders; track folder.folderID) {
              <option [value]="folder.folderID">{{ folder.folderName }}</option>
            }
          </select>
        </div>

        <!-- Has Attachment -->
        <div class="grid-row checkbox-row">
          <label></label> <!-- Spacer -->
          <div class="checkbox-group">
            <input type="checkbox" id="hasAttach" [(ngModel)]="options.hasAttachment">
            <label for="hasAttach">Has attachment</label>
          </div>
        </div>

      </div>

      <!-- Footer -->
      <div class="modal-footer">
        <button app-button variant="ghost" (click)="handleReset()">Reset</button>
        <button app-button (click)="handleSearch()">Search</button>
      </div>

    </div>
  </div>
}
